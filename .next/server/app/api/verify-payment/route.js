"use strict";(()=>{var e={};e.id=767,e.ids=[767],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},98216:e=>{e.exports=require("net")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},82452:e=>{e.exports=require("tls")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},3253:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>f,requestAsyncStorage:()=>c,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>l});var s={};r.r(s),r.d(s,{POST:()=>u});var i=r(49303),a=r(88716),n=r(60670),o=r(95e3),p=r(87070);async function u(e){try{let t=await (0,o.e)(),{data:{user:r}}=await t.auth.getUser();if(!r)return p.NextResponse.json({error:"Unauthorized"},{status:401});let{paymentId:s,status:i,verificationNotes:a}=await e.json();if(!s||!i)return p.NextResponse.json({error:"Missing required fields"},{status:400});let{data:n,error:u}=await t.from("payments").select("event_id, user_id").eq("id",s).single();if(u)return p.NextResponse.json({error:"Payment not found"},{status:404});let{data:d,error:c}=await t.from("events").select("organizer_id").eq("id",n.event_id).single();if(c||d.organizer_id!==r.id)return p.NextResponse.json({error:"Not authorized to verify this payment"},{status:403});let{error:l}=await t.from("payments").update({status:i,verification_notes:a,verified_by:r.id,verified_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",s);if(l)return p.NextResponse.json({error:"Failed to update payment status"},{status:500});if("verified"===i){let{error:e}=await t.from("participants").update({status:"confirmed"}).eq("payment_id",s);e&&console.error("Error updating participant status:",e)}else if("rejected"===i){let{error:e}=await t.from("participants").update({status:"cancelled"}).eq("payment_id",s);e&&console.error("Error updating participant status:",e)}return p.NextResponse.json({success:!0,message:`Payment ${i} successfully`})}catch(e){return console.error("Unexpected error verifying payment:",e),p.NextResponse.json({error:"An unexpected error occurred"},{status:500})}}let d=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/verify-payment/route",pathname:"/api/verify-payment",filename:"route",bundlePath:"app/api/verify-payment/route"},resolvedPagePath:"/Users/amrendravikramsingh/Downloads/eventManagement/src/app/api/verify-payment/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:c,staticGenerationAsyncStorage:l,serverHooks:m}=d,y="/api/verify-payment/route";function f(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:l})}},95e3:(e,t,r)=>{r.d(t,{e:()=>a});var s=r(16510),i=r(71615);let a=async()=>{let e=(0,i.cookies)();return(0,s.createServerClient)("https://ilctmtqojokjyuwsuufr.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlsY3RtdHFvam9ranl1d3N1dWZyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDgyODA0NjMsImV4cCI6MjA2Mzg1NjQ2M30.ShqPO7vf2fbckvgei4hhsY5tQYek6_86gimyYBW0byY",{cookies:{getAll:()=>e.getAll().map(({name:e,value:t})=>({name:e,value:t})),setAll(t){t.forEach(({name:t,value:r,options:s})=>{e.set(t,r,s)})}}})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,544,972],()=>r(3253));module.exports=s})();