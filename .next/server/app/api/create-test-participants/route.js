"use strict";(()=>{var e={};e.id=987,e.ids=[987],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},98216:e=>{e.exports=require("net")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},82452:e=>{e.exports=require("tls")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},88264:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>m,patchFetch:()=>h,requestAsyncStorage:()=>d,routeModule:()=>u,serverHooks:()=>g,staticGenerationAsyncStorage:()=>l});var i={};r.r(i),r.d(i,{POST:()=>p});var n=r(49303),s=r(88716),o=r(60670),a=r(95e3),c=r(87070);async function p(e){try{let t=await (0,a.e)(),{data:{user:r}}=await t.auth.getUser();if(!r)return console.error("No authenticated user found"),c.NextResponse.json({error:"Unauthorized"},{status:401});console.log("Authenticated user:",r.id);let{eventId:i,count:n=5}=await e.json();if(console.log("Creating test participants for event:",i,"count:",n),!i)return console.error("No event ID provided"),c.NextResponse.json({error:"Event ID is required"},{status:400});let{data:s,error:o}=await t.from("events").select(`
        id,
        organizer_id,
        pricing_tiers (
          id,
          name,
          price
        )
      `).eq("id",i).eq("organizer_id",r.id).single();if(o)return console.error("Error fetching event:",o),c.NextResponse.json({error:"Event not found or unauthorized"},{status:404});if(!s)return console.error("Event not found:",i),c.NextResponse.json({error:"Event not found"},{status:404});if(console.log("Found event:",{id:s.id,organizer_id:s.organizer_id,pricing_tiers_count:s.pricing_tiers?.length}),!s.pricing_tiers||0===s.pricing_tiers.length)return console.error("No pricing tiers found for event:",i),c.NextResponse.json({error:"No pricing tiers found for this event"},{status:400});console.log("Found pricing tiers:",s.pricing_tiers);let p=[],u=["John Doe","Jane Smith","Mike Johnson","Sarah Wilson","David Brown","Emily Davis","Chris Miller","Lisa Garcia","Tom Anderson","Amy Taylor"];for(let e=0;e<Math.min(n,10);e++)try{let r=s.pricing_tiers[Math.floor(Math.random()*s.pricing_tiers.length)],n=u[e]||`Test User ${e+1}`,o=`test${e+1}@example.com`,a=Date.now(),c=Math.random().toString(36).substring(2,8).toUpperCase(),{data:d,error:l}=await t.auth.admin.createUser({email:o,password:`Test${a}${c}`,email_confirm:!0,user_metadata:{name:n,is_test_user:!0}});if(l){console.error("Error creating test user:",l);continue}if(!d?.user?.id){console.error("No user ID returned from user creation");continue}console.log(`Creating test participant ${e+1}:`,{name:n,email:o,tier:r.name,amount:r.price,event_id:i,user_id:d.user.id});let g={event_id:i,user_id:d.user.id,pricing_tier_id:r.id,amount:r.price,transaction_id:`TEST_${a}_${c}`,upi_reference:`TEST_REF_${a}_${c}`,status:Math.random()>.3?"verified":"pending",verification_notes:`Test participant: ${n} (${o})`};console.log("Creating payment with data:",g);let{data:m,error:h}=await t.from("payments").insert(g).select().single();if(h){console.error("Error creating test payment:",h),await t.auth.admin.deleteUser(d.user.id);continue}console.log("Created payment:",m);let f={event_id:i,user_id:d.user.id,payment_id:m.id,status:"registered"};console.log("Creating participant with data:",f);let{error:x}=await t.from("participants").insert(f);if(x){console.error("Error creating participant:",x),await t.from("payments").delete().eq("id",m.id),await t.auth.admin.deleteUser(d.user.id);continue}console.log("Created participant for payment:",m.id),p.push({name:n,email:o,tier:r.name,amount:r.price,status:m.status})}catch(t){console.error(`Error creating test participant ${e+1}:`,t);continue}if(0===p.length)return console.error("Failed to create any test participants"),c.NextResponse.json({error:"Failed to create any test participants"},{status:500});return console.log("Successfully created test participants:",p),c.NextResponse.json({success:!0,message:`Created ${p.length} test participants`,participants:p})}catch(e){return console.error("Error creating test participants:",e),c.NextResponse.json({error:"An unexpected error occurred"},{status:500})}}let u=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/create-test-participants/route",pathname:"/api/create-test-participants",filename:"route",bundlePath:"app/api/create-test-participants/route"},resolvedPagePath:"/Users/amrendravikramsingh/Downloads/eventManagement/src/app/api/create-test-participants/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:d,staticGenerationAsyncStorage:l,serverHooks:g}=u,m="/api/create-test-participants/route";function h(){return(0,o.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:l})}},95e3:(e,t,r)=>{r.d(t,{e:()=>s});var i=r(16510),n=r(71615);let s=async()=>{let e=(0,n.cookies)();return(0,i.createServerClient)("https://ilctmtqojokjyuwsuufr.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlsY3RtdHFvam9ranl1d3N1dWZyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDgyODA0NjMsImV4cCI6MjA2Mzg1NjQ2M30.ShqPO7vf2fbckvgei4hhsY5tQYek6_86gimyYBW0byY",{cookies:{getAll:()=>e.getAll().map(({name:e,value:t})=>({name:e,value:t})),setAll(t){t.forEach(({name:t,value:r,options:i})=>{e.set(t,r,i)})}}})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[948,544,972],()=>r(88264));module.exports=i})();